const $=document.querySelector.bind(document);let id=localStorage.getItem("id");if(!id){const e=prompt("What your name ?");id=setid(e)}let output=$("#output");const ws=new WebSocket(`wss://${window.location.host}`);async function covertData(e){let t=await e.data;return t=await t.text()}function newMessage(e,t){let n=document.createElement("div");n.innerText=e.message,n.className=`message badge rounded  fs-6 ${t==e.id?"bg-primary personal":"bg- others"}`,output.appendChild(n),output.scrollBy(0,window.innerHeight)}function setid(e){let t=e.toUpperCase()+(Math.random()+1).toString(36).substring(2);return localStorage.setItem("id",t),t}$("#form").addEventListener("submit",e=>{e.stopPropagation(),e.preventDefault();let t=$("#message");if(""==!t.value.trim()||null==!t.value.trim()){let e=JSON.stringify({id:id,name:name,message:t.value.trim()});ws.send(e)}else console.log("error");t.value=null}),ws.addEventListener("message",async e=>{try{const t=await covertData(event);console.log(t);const n=JSON.parse(t);console.log(n),newMessage(n,id)}catch(e){console.log(e)}}),ws.addEventListener("close",e=>{localStorage.removeItem("id")});
